def apply_classification(classification):

    '''
    wind_stock_classification

    csrc_stock_classification
    
    joinquant_stock_classification
    '''

    invest_detail_ = pd.merge(csmar_monthly_stock_mkt_value, classification[['Stkcd', 'Indnme']], on='Stkcd', validate='m:1')
    invest_detail_ = invest_detail_.rename(columns={'EndDate': 'Date'})
    invest_detail_['Date'] = pd.to_datetime(invest_detail_.Date).dt.to_period('M')

    month_mkt_value_ = pd.merge(csmar_monthly_stock_mkt_value, classification, on='Stkcd', validate='m:1')
    month_mkt_value_ = month_mkt_value_.groupby(['Trdmnt', 'Indnme']).apply(lambda x: x.Msmvttl.sum())
    month_mkt_value_ = month_mkt_value_.unstack().div(month_mkt_value_.unstack().sum(axis=1), axis=0).fillna(0)
    month_mkt_value_.index = pd.to_datetime(month_mkt_value_.index).to_period('M')
    month_mkt_value_.index.name = 'Date'

    return invest_detail_, month_mkt_value_
    